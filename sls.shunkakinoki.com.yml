acl: ${env.AWS_ACL_ARN}
"@shunkakinoki/shunkakinoki.com":
  component: "./node_modules/@sls-next/serverless-component"
  inputs:
    build:
      postBuildCommands:
        - PDIR=node_modules/.prisma/client/;
          LDIR=.serverless_nextjs/api-lambda/;
          if [ "$(ls -A $LDIR)" ]; then
          mkdir -p $LDIR$PDIR;
          cp "$PDIR"query-engine-rhel-* $LDIR$PDIR;
          cp "$PDIR"schema.prisma $LDIR$PDIR;
          fi;
        - PDIR=node_modules/.prisma/client/;
          LDIR=.serverless_nextjs/default-lambda/;
          if [ "$(ls -A $LDIR)" ]; then
          mkdir -p $LDIR$PDIR;
          cp "$PDIR"query-engine-rhel-* $LDIR$PDIR;
          cp "$PDIR"schema.prisma $LDIR$PDIR;
          fi;
    certificateArn: ${acl}
    cloudfront:
      defaults:
        forward:
          headers:
            - Host
    domain: ["shunkakinoki.com"]
    domainType: "both"
    domainRedirects:
      www.shunkakinoki.com: https://shunkakinoki.com
    memory: "2048"
    minifyHandlers: true
    runtime: "nodejs14.x"
    timeout:
      defaultLambda: 30
      apiLambda: 30
      imageLambda: 30
    useServerlessTraceTarget: true
